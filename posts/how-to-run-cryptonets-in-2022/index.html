<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>How to Run CryptoNets in 2022 | 知日</title><meta name=keywords content><meta name=description content="Introduction More and more companies have built applications based on big data techniques in recent years. To have a well-performance model, collecting data has become a must. However, the consciousness of privacy raises in many people’s minds, and they are less willing to give data to companies. As a result, data protection has become a vital technique to balance the dilemma between big data and data privacy.
In 2016, Microsoft Research published CryptoNets [1], the first paper to infer a CNN model in the encrypted domain."><meta name=author content><link rel=canonical href=https://whcjimmy.github.io/posts/how-to-run-cryptonets-in-2022/><link crossorigin=anonymous href=/assets/css/stylesheet.min.c88963fe2d79462000fd0fb1b3737783c32855d340583e4523343f8735c787f0.css integrity="sha256-yIlj/i15RiAA/Q+xs3N3g8MoVdNAWD5FIzQ/hzXHh/A=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.min.7680afc38aa6b15ddf158a4f3780b7b1f7dde7e91d26f073e6229bb7a0793c92.js integrity="sha256-doCvw4qmsV3fFYpPN4C3sffd5+kdJvBz5iKbt6B5PJI=" onload=hljs.initHighlightingOnLoad()></script><link rel=icon href=https://whcjimmy.github.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://whcjimmy.github.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://whcjimmy.github.io/favicon-32x32.png><link rel=apple-touch-icon href=https://whcjimmy.github.io/apple-touch-icon.png><link rel=mask-icon href=https://whcjimmy.github.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:title" content="How to Run CryptoNets in 2022"><meta property="og:description" content="Introduction More and more companies have built applications based on big data techniques in recent years. To have a well-performance model, collecting data has become a must. However, the consciousness of privacy raises in many people’s minds, and they are less willing to give data to companies. As a result, data protection has become a vital technique to balance the dilemma between big data and data privacy.
In 2016, Microsoft Research published CryptoNets [1], the first paper to infer a CNN model in the encrypted domain."><meta property="og:type" content="article"><meta property="og:url" content="https://whcjimmy.github.io/posts/how-to-run-cryptonets-in-2022/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2022-02-23T23:53:17+08:00"><meta property="article:modified_time" content="2022-02-23T23:53:17+08:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="How to Run CryptoNets in 2022"><meta name=twitter:description content="Introduction More and more companies have built applications based on big data techniques in recent years. To have a well-performance model, collecting data has become a must. However, the consciousness of privacy raises in many people’s minds, and they are less willing to give data to companies. As a result, data protection has become a vital technique to balance the dilemma between big data and data privacy.
In 2016, Microsoft Research published CryptoNets [1], the first paper to infer a CNN model in the encrypted domain."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://whcjimmy.github.io/posts/"},{"@type":"ListItem","position":2,"name":"How to Run CryptoNets in 2022","item":"https://whcjimmy.github.io/posts/how-to-run-cryptonets-in-2022/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"How to Run CryptoNets in 2022","name":"How to Run CryptoNets in 2022","description":"Introduction More and more companies have built applications based on big data techniques in recent years. To have a well-performance model, collecting data has become a must. However, the consciousness of privacy raises in many people’s minds, and they are less willing to give data to companies. As a result, data protection has become a vital technique to balance the dilemma between big data and data privacy.\nIn 2016, Microsoft Research published CryptoNets [1], the first paper to infer a CNN model in the encrypted domain.","keywords":[],"articleBody":"Introduction More and more companies have built applications based on big data techniques in recent years. To have a well-performance model, collecting data has become a must. However, the consciousness of privacy raises in many people’s minds, and they are less willing to give data to companies. As a result, data protection has become a vital technique to balance the dilemma between big data and data privacy.\nIn 2016, Microsoft Research published CryptoNets [1], the first paper to infer a CNN model in the encrypted domain. The main idea of CryptoNets is to infer encrypted data in the encrypted domain, and the protocol is under a client who has sensible data and a company that has a CNN model. At the beginning of the protocol, a client encrypts his data with his public key and sends it to the company. Next, when the company receives the encrypted image, he infers the image in the encrypted domain and sends the result back to the client. After the client gets the encrypted result, he decrypts the result with his private key, and now he gets the meaning of the result. Because the whole process is in the encrypted domain, the company doesn’t have any information about this image. As a result, CryptoNets can effectively protect data privacy.\nAlthough CryptoNets is good for beginners to know how to infer data in the encrypted domain, after Microsoft Research released related code in 2019, the code doesn’t be updated anymore. In this post, I will tell you how to run CryptoNets in 2022.\nPrerequisites Before we start, we need the following things:\n  Visual Studio 2022\nMicrosoft Research wrote CryptoNets in C#, so we need VS to compile the project. The installation instructions are in the next section.\n  SEAL Repo\nI’ve updated the setting files for VS 2022, so I recommend you clone the branch cryptonets_with_vs_2022 of my fork.\n  CryptoNets Repo\nYou can get the repo from here.\n  NuGet Package command line tool\nFollowing the official manual, we need to pack SEAL Library into a NuGet package file. You can get the command-line tool from here.   MNIST Dataset\nYou can find the dataset from here. Both training dataset and testing dataset are needed.\n  Installation Guides If eveything is set up, let’s get started!\n  Install visual studio 2022\nYou need to install VS 2022 with the following requirements:\n Desktop Development with C++ .Net Desktop Development C++ Cmake tools for Windows C++ Cmake tools for Linux .Net Framework 4.8 .Net Framework 4.8 targeting pack .Net Core 2.1 Runtime (out of support)     Compile SEAL Library (the folloing steps are under SEAL Repo)\n  Use VS to open ./donet/src/SEALNET.csproj and accept all review solution actions.   Build the following three projects after setting the configuration as Release and the platform as x64.\n ./native/src/SEAL.vcxproj ./dotnet/native/SEALNetNative.vcxproj ./dotnet/src/SEALNet.csproj     Put NuGet command-line tool into  ./dotnet/nuget folder.   Open ./dotnet/nuget with CMD and enter the following command to build nuget packages. The SEAL nupkg file is generated under ./dotnet/nuget/Release.\nnuget pack SEALNet.nuspec -properties Configuration=Release -Verbosity detailed -OutputDir Release   Copy the SEAL nupkg file to the root directory of CryptoNets Repo.     Compile CryptoNets Project (the folloing steps are under CryptoNets Repo)\n  Use VS to open ./CryptoNets/CryptoNets.sln and updfatre the .Net Framework version.   Follow Tool - Nuget Package Manager - Manage NuGet Packages for Solution to import SEAL nupkg file.\nIf you cannot find the SEAL nupgk file, you may need to restart visual studio.   Build DataPreprocess and CryptoNets projects after set the configuration as Debug and the platform as x64, .   Put the MNIST dataset files into ./bin/x64/Debug/.     Run CryptoNets (the folloing steps are also under CryptoNets Repo)\n Open CMD and cd to ./bin/x64/Debug. Execute DataPreprocess.exe MNIST to generate MNIST-28-28-test.txt for CryptoNets.exe.  Execute CryptoNets.exe. This program will train a CNN model first and start to infer images in the encrypted domain.     Conclusion This post showed how to run CryptoNets with visual studio 2022. If you are interested in this research topic, there are other applications you can also try in the CryptoNets repo.\nReferences  CryptoNets My fork of Microsoft SEAL Library The offical repo of SEAL The offical repo of CryptoNets  ","wordCount":"682","inLanguage":"en","datePublished":"2022-02-23T23:53:17+08:00","dateModified":"2022-02-23T23:53:17+08:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://whcjimmy.github.io/posts/how-to-run-cryptonets-in-2022/"},"publisher":{"@type":"Organization","name":"知日","logo":{"@type":"ImageObject","url":"https://whcjimmy.github.io/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add('dark'):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove('dark'):window.matchMedia('(prefers-color-scheme: dark)').matches&&document.body.classList.add('dark')</script><header class=header><nav class=nav><div class=logo><a href=https://whcjimmy.github.io/ accesskey=h title="知日 (Alt + H)">知日</a>
<span class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></span></div><ul id=menu></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class=post-title>How to Run CryptoNets in 2022</h1><div class=post-meta><span title="2022-02-23 23:53:17 +0800 +0800">February 23, 2022</span></div></header><div class=post-content><h1 id=introduction>Introduction<a hidden class=anchor aria-hidden=true href=#introduction>#</a></h1><p>More and more companies have built applications based on big data techniques in recent years. To have a well-performance model, collecting data has become a must. However, the consciousness of privacy raises in many people’s minds, and they are less willing to give data to companies. As a result, data protection has become a vital technique to balance the dilemma between big data and data privacy.</p><p>In 2016, Microsoft Research published CryptoNets [1], the first paper to infer a CNN model in the encrypted domain. The main idea of CryptoNets is to infer encrypted data in the encrypted domain, and the protocol is under a client who has sensible data and a company that has a CNN model. At the beginning of the protocol, a client encrypts his data with his public key and sends it to the company. Next, when the company receives the encrypted image, he infers the image in the encrypted domain and sends the result back to the client. After the client gets the encrypted result, he decrypts the result with his private key, and now he gets the meaning of the result. Because the whole process is in the encrypted domain, the company doesn’t have any information about this image. As a result, CryptoNets can effectively protect data privacy.</p><p>Although CryptoNets is good for beginners to know how to infer data in the encrypted domain, after Microsoft Research released related code in 2019, the code doesn’t be updated anymore. In this post, I will tell you how to run CryptoNets in 2022.</p><h1 id=prerequisites>Prerequisites<a hidden class=anchor aria-hidden=true href=#prerequisites>#</a></h1><p>Before we start, we need the following things:</p><ol><li><p><strong>Visual Studio 2022</strong></p><p>Microsoft Research wrote CryptoNets in C#, so we need VS to compile the project. The installation instructions are in the next section.</p></li><li><p><strong>SEAL Repo</strong></p><p>I&rsquo;ve updated the setting files for VS 2022, so I recommend you clone the branch <code>cryptonets_with_vs_2022</code> of <a href=https://github.com/whcjimmy/SEAL/tree/cryptonets_with_vs_2022>my fork</a>.</p></li><li><p><strong>CryptoNets Repo</strong></p><p>You can get the repo from <a href=https://github.com/microsoft/CryptoNets>here</a>.</p></li><li><p><strong>NuGet Package command line tool</strong></p><p>Following the official manual, we need to pack SEAL Library into a NuGet package file. You can get the command-line tool from <a href=https://docs.microsoft.com/en-us/nuget/install-nuget-client-tools>here</a>.
<img loading=lazy src=/images/how-to-run-cryptonets-in-2022/2022-02-24-150732.png alt=image_7></p></li><li><p><strong>MNIST Dataset</strong></p><p>You can find the dataset from <a href=http://yann.lecun.com/exdb/mnist/>here</a>. Both training dataset and testing dataset are needed.</p></li></ol><h1 id=installation-guides>Installation Guides<a hidden class=anchor aria-hidden=true href=#installation-guides>#</a></h1><p>If eveything is set up, let&rsquo;s get started!</p><ol><li><p><strong>Install visual studio 2022</strong></p><p>You need to install VS 2022 with the following requirements:</p><ul><li>Desktop Development with C++</li><li>.Net Desktop Development</li><li>C++ Cmake tools for Windows</li><li>C++ Cmake tools for Linux</li><li>.Net Framework 4.8</li><li>.Net Framework 4.8 targeting pack</li><li>.Net Core 2.1 Runtime (out of support)
<img loading=lazy src=/images/how-to-run-cryptonets-in-2022/2022-02-24-162559.png alt=image_1>
<img loading=lazy src=/images/how-to-run-cryptonets-in-2022/2022-02-24-162613.png alt=image_2>
<img loading=lazy src=/images/how-to-run-cryptonets-in-2022/2022-02-24-162626.png alt=image_3>
<img loading=lazy src=/images/how-to-run-cryptonets-in-2022/2022-02-24-162646.png alt=image_4></li></ul></li><li><p><strong>Compile SEAL Library</strong> (the folloing steps are under SEAL Repo)</p><ol><li><p>Use VS to open <code>./donet/src/SEALNET.csproj</code> and accept all review solution actions.
<img loading=lazy src=/images/how-to-run-cryptonets-in-2022/2022-02-21-202909.png alt=image_5>
<img loading=lazy src=/images/how-to-run-cryptonets-in-2022/2022-02-21-202939.png alt=image_6></p></li><li><p>Build the following three projects after setting the configuration as <code>Release</code> and the platform as <code>x64</code>.</p><ol><li><code>./native/src/SEAL.vcxproj</code></li><li><code>./dotnet/native/SEALNetNative.vcxproj</code></li><li><code>./dotnet/src/SEALNet.csproj</code>
<img loading=lazy src=/images/how-to-run-cryptonets-in-2022/2022-02-24-111353.png alt=image_7>
<img loading=lazy src=/images/how-to-run-cryptonets-in-2022/2022-02-21-203125.png alt=image_7>
<img loading=lazy src=/images/how-to-run-cryptonets-in-2022/2022-02-24-111444.png alt=image_7></li></ol></li><li><p>Put NuGet command-line tool into <code>./dotnet/nuget</code> folder.
<img loading=lazy src=/images/how-to-run-cryptonets-in-2022/2022-02-24-111723.png alt=image_8></p></li><li><p>Open <code>./dotnet/nuget</code> with CMD and enter the following command to build nuget packages. The SEAL nupkg file is generated under <code>./dotnet/nuget/Release</code>.</p><p><code>nuget pack SEALNet.nuspec -properties Configuration=Release -Verbosity detailed -OutputDir Release</code>
<img loading=lazy src=/images/how-to-run-cryptonets-in-2022/2022-02-24-111619.png alt=image_9>
<img loading=lazy src=/images/how-to-run-cryptonets-in-2022/2022-02-24-111704.png alt=image_9></p></li><li><p>Copy the SEAL nupkg file to the root directory of CryptoNets Repo.
<img loading=lazy src=/images/how-to-run-cryptonets-in-2022/2022-02-24-111814.png alt=image_9></p></li></ol></li><li><p><strong>Compile CryptoNets Project</strong> (the folloing steps are under CryptoNets Repo)</p><ol><li><p>Use VS to open <code>./CryptoNets/CryptoNets.sln</code> and updfatre the .Net Framework version.
<img loading=lazy src=/images/how-to-run-cryptonets-in-2022/2022-02-21-203947.png alt=image_10>
<img loading=lazy src=/images/how-to-run-cryptonets-in-2022/2022-02-21-204004.png alt=image_11></p></li><li><p>Follow <code>Tool -> Nuget Package Manager -> Manage NuGet Packages for Solution</code> to import SEAL nupkg file.</p><p>If you cannot find the SEAL nupgk file, you may need to restart visual studio.
<img loading=lazy src=/images/how-to-run-cryptonets-in-2022/2022-02-21-205028.png alt=image_12></p></li><li><p>Build DataPreprocess and CryptoNets projects after set the configuration as <code>Debug</code> and the platform as <code>x64</code>, .
<img loading=lazy src=/images/how-to-run-cryptonets-in-2022/2022-02-21-205224.png alt=image_13>
<img loading=lazy src=/images/how-to-run-cryptonets-in-2022/2022-02-21-205241.png alt=image_14>
<img loading=lazy src=/images/how-to-run-cryptonets-in-2022/2022-02-21-204047.png alt=image_15>
<img loading=lazy src=/images/how-to-run-cryptonets-in-2022/2022-02-24-153204.png alt=image_15></p></li><li><p>Put the MNIST dataset files into <code>./bin/x64/Debug/</code>.
<img loading=lazy src=/images/how-to-run-cryptonets-in-2022/2022-02-21-205913.png alt=image_16></p></li></ol></li><li><p><strong>Run CryptoNets</strong> (the folloing steps are also under CryptoNets Repo)</p><ol><li>Open CMD and cd to <code>./bin/x64/Debug</code>.</li><li>Execute <code>DataPreprocess.exe MNIST</code> to generate <code>MNIST-28-28-test.txt</code> for CryptoNets.exe.
<img loading=lazy src=/images/how-to-run-cryptonets-in-2022/2022-02-21-210014.png alt=image_17></li><li>Execute <code>CryptoNets.exe</code>. This program will train a CNN model first and start to infer images in the encrypted domain.
<img loading=lazy src=/images/how-to-run-cryptonets-in-2022/2022-02-21-210425.png alt=image_18></li></ol></li></ol><h1 id=conclusion>Conclusion<a hidden class=anchor aria-hidden=true href=#conclusion>#</a></h1><p>This post showed how to run CryptoNets with visual studio 2022. If you are interested in this research topic, there are other applications you can also try in the CryptoNets repo.</p><h1 id=references>References<a hidden class=anchor aria-hidden=true href=#references>#</a></h1><ol><li><a href=https://proceedings.mlr.press/v48/gilad-bachrach16.html>CryptoNets</a></li><li><a href=https://github.com/whcjimmy/SEAL/tree/CryptoNets_with_vs_2022>My fork of Microsoft SEAL Library</a></li><li><a href=https://github.com/microsoft/SEAL>The offical repo of SEAL</a></li><li><a href=https://github.com/microsoft/CryptoNets>The offical repo of CryptoNets</a></li></ol></div><footer class=post-footer></footer></article></main><footer class=footer><span>&copy; 2022 <a href=https://whcjimmy.github.io/>知日</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://git.io/hugopapermod rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById('menu');menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(a=>{a.addEventListener("click",function(b){b.preventDefault();var a=this.getAttribute("href").substr(1);window.matchMedia('(prefers-reduced-motion: reduce)').matches?document.querySelector(`[id='${decodeURIComponent(a)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(a)}']`).scrollIntoView({behavior:"smooth"}),a==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${a}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove('dark'),localStorage.setItem("pref-theme",'light')):(document.body.classList.add('dark'),localStorage.setItem("pref-theme",'dark'))})</script></body></html>