<!doctype html><html lang=zh-tw><head><title>How to Run CryptoNets in 2022 | Áü•Êó•</title><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge,chrome=1"><meta name=viewport content="width=device-width,minimum-scale=1"><meta name=description content="This is a post about how to install and run CryptoNets in 2022."><meta name=generator content="Hugo 0.81.0"><meta name=ROBOTS content="NOINDEX, NOFOLLOW"><link rel=stylesheet href=/css/style.css><link rel="shortcut icon" href=/images/favicon.ico type=image/x-icon><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.13.13/dist/katex.min.css integrity=sha384-RZU/ijkSsFbcmivfdRBQDtwuwVqK7GMOw6IMvKyeWL2K5UAlyp6WonmB8m7Jd0Hn crossorigin=anonymous><script defer src=https://cdn.jsdelivr.net/npm/katex@0.13.13/dist/katex.min.js integrity=sha384-pK1WpvzWVBQiP0/GjnvRxV4mOb0oxFuyRxJlk6vVw146n3egcN5C925NCP7a7BY8 crossorigin=anonymous></script><script defer src=https://cdn.jsdelivr.net/npm/katex@0.13.13/dist/contrib/auto-render.min.js integrity=sha384-vZTG03m+2yp6N6BNi5iM4rW4oIwk5DfcNdFfxkk9ZWpDriOkXX8voJBFrAO7MpVl crossorigin=anonymous onload=renderMathInElement(document.body)></script></head><body><nav class=navigation><a href=/><span class=arrow>‚Üê</span>Home</a>
<a href=/posts>Archive</a>
<a href=/tags>Tags</a>
<a href=/about>About</a>
<a class=button href=https://whcjimmy.github.io/index.xml>Subscribe</a></nav><main class=main><section id=single><h1 class=title>How to Run CryptoNets in 2022</h1><div class=tip><time datetime="2022-02-23 23:53:17 +0800 +0800">Feb 23, 2022</time>
<span class=split>¬∑</span>
<span>696 words</span>
<span class=split>¬∑</span>
<span>4 minute read</span></div><div class=content><p>This is a post about how to install and run CryptoNets in 2022.</p><h1 id=introduction>Introduction <a href=#introduction class=anchor>üîó</a></h1><p>More and more companies have built applications based on big data techniques in recent years. To have a well-performance model, collecting data has become a must. However, the consciousness of privacy raises in many people‚Äôs minds, and they are less willing to give data to companies. As a result, data protection has become a vital technique to balance the dilemma between big data and data privacy.</p><p>In 2016, Microsoft Research published CryptoNets [1], the first paper to infer a CNN model in the encrypted domain. The main idea of CryptoNets is to infer encrypted data in the encrypted domain, and the protocol is under a client who has sensible data and a company that has a CNN model. At the beginning of the protocol, a client encrypts his data with his public key and sends it to the company. Next, when the company receives the encrypted image, he infers the image in the encrypted domain and sends the result back to the client. After the client gets the encrypted result, he decrypts the result with his private key, and now he gets the meaning of the result. Because the whole process is in the encrypted domain, the company doesn‚Äôt have any information about this image. As a result, CryptoNets can effectively protect data privacy.</p><p>Although CryptoNets is good for beginners to know how to infer data in the encrypted domain, after Microsoft Research released related code in 2019, the code doesn‚Äôt be updated anymore. In this post, I will tell you how to run CryptoNets in 2022.</p><h1 id=prerequisites>Prerequisites <a href=#prerequisites class=anchor>üîó</a></h1><p>Before we start, we need the following things:</p><ol><li><p><strong>Visual Studio 2022</strong></p><p>Microsoft Research wrote CryptoNets in C#, so we need VS to compile the project. The installation instructions are in the next section.</p></li><li><p><strong>SEAL Repo</strong></p><p>I&rsquo;ve updated the setting files for VS 2022, so I recommend you clone the branch <code>cryptonets_with_vs_2022</code> of <a href=https://github.com/whcjimmy/SEAL/tree/cryptonets_with_vs_2022 target=_blank rel=noopener>my fork</a>.</p></li><li><p><strong>CryptoNets Repo</strong></p><p>You can get the repo from <a href=https://github.com/microsoft/CryptoNets target=_blank rel=noopener>here</a>.</p></li><li><p><strong>NuGet Package command line tool</strong></p><p>Following the official manual, we need to pack SEAL Library into a NuGet package file. You can get the command-line tool from <a href=https://docs.microsoft.com/en-us/nuget/install-nuget-client-tools target=_blank rel=noopener>here</a>.<p class=markdown-image><img src=/images/how-to-run-cryptonets-in-2022/2022-02-24-150732.png alt=image_7></p></p></li><li><p><strong>MNIST Dataset</strong></p><p>You can find the dataset from <a href=http://yann.lecun.com/exdb/mnist/ target=_blank rel=noopener>here</a>. Both training dataset and testing dataset are needed.</p></li></ol><h1 id=installation-guides>Installation Guides <a href=#installation-guides class=anchor>üîó</a></h1><p>If eveything is set up, let&rsquo;s get started!</p><ol><li><p><strong>Install visual studio 2022</strong></p><p>You need to install VS 2022 with the following requirements:</p><ul><li>Desktop Development with C++</li><li>.Net Desktop Development</li><li>C++ Cmake tools for Windows</li><li>C++ Cmake tools for Linux</li><li>.Net Framework 4.8</li><li>.Net Framework 4.8 targeting pack</li><li>.Net Core 2.1 Runtime (out of support)<p class=markdown-image><img src=/images/how-to-run-cryptonets-in-2022/2022-02-24-162559.png alt=image_1></p><p class=markdown-image><img src=/images/how-to-run-cryptonets-in-2022/2022-02-24-162613.png alt=image_2></p><p class=markdown-image><img src=/images/how-to-run-cryptonets-in-2022/2022-02-24-162626.png alt=image_3></p><p class=markdown-image><img src=/images/how-to-run-cryptonets-in-2022/2022-02-24-162646.png alt=image_4></p></li></ul></li><li><p><strong>Compile SEAL Library</strong> (the folloing steps are under SEAL Repo)</p><ol><li><p>Use VS to open <code>./donet/src/SEALNET.csproj</code> and accept all review solution actions.<p class=markdown-image><img src=/images/how-to-run-cryptonets-in-2022/2022-02-21-202909.png alt=image_5></p><p class=markdown-image><img src=/images/how-to-run-cryptonets-in-2022/2022-02-21-202939.png alt=image_6></p></p></li><li><p>Build the following three projects after setting the configuration as <code>Release</code> and the platform as <code>x64</code>.</p><ol><li><code>./native/src/SEAL.vcxproj</code></li><li><code>./dotnet/native/SEALNetNative.vcxproj</code></li><li><code>./dotnet/src/SEALNet.csproj</code><p class=markdown-image><img src=/images/how-to-run-cryptonets-in-2022/2022-02-24-111353.png alt=image_7></p><p class=markdown-image><img src=/images/how-to-run-cryptonets-in-2022/2022-02-21-203125.png alt=image_7></p><p class=markdown-image><img src=/images/how-to-run-cryptonets-in-2022/2022-02-24-111444.png alt=image_7></p></li></ol></li><li><p>Put NuGet command-line tool into <code>./dotnet/nuget</code> folder.<p class=markdown-image><img src=/images/how-to-run-cryptonets-in-2022/2022-02-24-111723.png alt=image_8></p></p></li><li><p>Open <code>./dotnet/nuget</code> with CMD and enter the following command to build nuget packages. The SEAL nupkg file is generated under <code>./dotnet/nuget/Release</code>.</p><p><code>nuget pack SEALNet.nuspec -properties Configuration=Release -Verbosity detailed -OutputDir Release</code><p class=markdown-image><img src=/images/how-to-run-cryptonets-in-2022/2022-02-24-111619.png alt=image_9></p><p class=markdown-image><img src=/images/how-to-run-cryptonets-in-2022/2022-02-24-111704.png alt=image_9></p></p></li><li><p>Copy the SEAL nupkg file to the root directory of CryptoNets Repo.<p class=markdown-image><img src=/images/how-to-run-cryptonets-in-2022/2022-02-24-111814.png alt=image_9></p></p></li></ol></li><li><p><strong>Compile CryptoNets Project</strong> (the folloing steps are under CryptoNets Repo)</p><ol><li><p>Use VS to open <code>./CryptoNets/CryptoNets.sln</code> and updfatre the .Net Framework version.<p class=markdown-image><img src=/images/how-to-run-cryptonets-in-2022/2022-02-21-203947.png alt=image_10></p><p class=markdown-image><img src=/images/how-to-run-cryptonets-in-2022/2022-02-21-204004.png alt=image_11></p></p></li><li><p>Follow <code>Tool -> Nuget Package Manager -> Manage NuGet Packages for Solution</code> to import SEAL nupkg file.</p><p>If you cannot find the SEAL nupgk file, you may need to restart visual studio.<p class=markdown-image><img src=/images/how-to-run-cryptonets-in-2022/2022-02-21-205028.png alt=image_12></p></p></li><li><p>Build DataPreprocess and CryptoNets projects after set the configuration as <code>Debug</code> and the platform as <code>x64</code>, .<p class=markdown-image><img src=/images/how-to-run-cryptonets-in-2022/2022-02-21-205224.png alt=image_13></p><p class=markdown-image><img src=/images/how-to-run-cryptonets-in-2022/2022-02-21-205241.png alt=image_14></p><p class=markdown-image><img src=/images/how-to-run-cryptonets-in-2022/2022-02-21-204047.png alt=image_15></p><p class=markdown-image><img src=/images/how-to-run-cryptonets-in-2022/2022-02-24-153204.png alt=image_15></p></p></li><li><p>Put the MNIST dataset files into <code>./bin/x64/Debug/</code>.<p class=markdown-image><img src=/images/how-to-run-cryptonets-in-2022/2022-02-21-205913.png alt=image_16></p></p></li></ol></li><li><p><strong>Run CryptoNets</strong> (the folloing steps are also under CryptoNets Repo)</p><ol><li>Open CMD and cd to <code>./bin/x64/Debug</code>.</li><li>Execute <code>DataPreprocess.exe MNIST</code> to generate <code>MNIST-28-28-test.txt</code> for CryptoNets.exe.<p class=markdown-image><img src=/images/how-to-run-cryptonets-in-2022/2022-02-21-210014.png alt=image_17></p></li><li>Execute <code>CryptoNets.exe</code>. This program will train a CNN model first and start to infer images in the encrypted domain.<p class=markdown-image><img src=/images/how-to-run-cryptonets-in-2022/2022-02-21-210425.png alt=image_18></p></li></ol></li></ol><h1 id=conclusion>Conclusion <a href=#conclusion class=anchor>üîó</a></h1><p>This post showed how to run CryptoNets with visual studio 2022. If you are interested in this research topic, there are other applications you can also try in the CryptoNets repo.</p><h1 id=references>References <a href=#references class=anchor>üîó</a></h1><ol><li><a href=https://proceedings.mlr.press/v48/gilad-bachrach16.html target=_blank rel=noopener>CryptoNets</a></li><li><a href=https://github.com/whcjimmy/SEAL/tree/CryptoNets_with_vs_2022 target=_blank rel=noopener>My fork of Microsoft SEAL Library</a></li><li><a href=https://github.com/microsoft/SEAL target=_blank rel=noopener>The offical repo of SEAL</a></li><li><a href=https://github.com/microsoft/CryptoNets target=_blank rel=noopener>The offical repo of CryptoNets</a></li></ol></div><div id=comment></div></section></main><footer id=footer><div id=social><a class=symbol href=https://github.com/whcjimmy rel=me target=_blank><svg fill="#bbb" width="28" height="28" viewBox="0 0 72 72" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><title>Github</title><desc>Created with Sketch.</desc><defs/><g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g id="Social-Icons---Rounded-Black" transform="translate(-264.000000, -939.000000)"><g id="Github" transform="translate(264.000000, 939.000000)"><path d="M8 72H64c4.418278.0 8-3.581722 8-8V8c0-4.418278-3.581722-8-8-8H8c-4.418278 811624501e-24-8 3.581722-8 8V64c541083001e-24 4.418278 3.581722 8 8 8z" id="Rounded" fill="#bbb"/><path d="M35.9985 13C22.746 13 12 23.7870921 12 37.096644c0 10.6440272 6.876 19.6751861 16.4145 22.8617681C29.6145 60.1797862 30.0525 59.4358488 30.0525 58.7973276 30.0525 58.2250681 30.0315 56.7100863 30.0195 54.6996482c-6.6765 1.4562499-8.085-3.2302544-8.085-3.2302544-1.0905-2.7829884-2.664-3.5239139-2.664-3.5239139C17.091 46.4500754 19.4355 46.4801943 19.4355 46.4801943c2.4075.1701719 3.675 2.4833051 3.675 2.4833051 2.142 3.6820383 5.6175 2.6188404 6.9855 2.0014024C30.3135 49.4077535 30.9345 48.3460615 31.62 47.7436831 26.2905 47.1352808 20.688 45.0691228 20.688 35.8361671c0-2.6308879.9345-4.781379 2.4705-6.4665327C22.911 28.7597262 22.0875 26.3110578 23.3925 22.9934585c0 0 2.016-.6475568 6.6 2.4697516C31.908 24.9285993 33.96 24.6620468 36.0015 24.6515052 38.04 24.6620468 40.0935 24.9285993 42.0105 25.4632101c4.581-3.1173084 6.5925-2.4697516 6.5925-2.4697516C49.9125 26.3110578 49.089 28.7597262 48.8415 29.3696344 50.3805 31.0547881 51.309 33.2052792 51.309 35.8361671c0 9.2555448-5.6115 11.29309-10.9575 11.8894446.860999999999997.7439374 1.629 2.2137408 1.629 4.4621184C41.9805 55.4089489 41.9505 58.0067059 41.9505 58.7973276 41.9505 59.4418726 42.3825 60.1918338 43.6005 59.9554002 53.13 56.7627944 60 47.7376593 60 37.096644 60 23.7870921 49.254 13 35.9985 13" fill="#fff"/></g></g></g></svg></a></div><div class=copyright>¬© Copyright
2022
<span class=split><svg fill="#bbb" width="15" height="15" id="heart-15" xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 15 15"><path d="M13.91 6.75c-1.17 2.25-4.3 5.31-6.07 6.94-.1903.1718-.4797.1718-.67.0C5.39 12.06 2.26 9 1.09 6.75-1.48 1.8 5-1.5 7.5 3.45 10-1.5 16.48 1.8 13.91 6.75z"/></svg></span>Huan-Chih (Jimmy) Wang</div><div class=powerby>Powered by <a href=http://www.gohugo.io/>Hugo</a> Theme By <a href=https://https://github.com/nodejh/hugo-theme-mini>nodejh</a></div></footer></body></html>